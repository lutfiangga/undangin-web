---
import fixnikah from "../assets/img/fixnikah.webp";
import guest from "../assets/img/guest.webp";
---

<section
  class="min-h-svh max-h-[894px] relative flex flex-col items-center justify-center text-center overflow-hidden"
>
  <div
    class="p-4 mt-6 min-h-svh w-full relative flex flex-col items-center justify-center text-center"
  >
    <div
      class="relative w-full flex flex-col items-center justify-center space-y-4"
    >
      <!-- nikahfix logo -->
      <img src={fixnikah.src} alt="nikahfix" class="w-[260px]" />
      <p class="font-serif mt-4">Who's Watching?</p>
      <img src={guest.src} alt="guest" class="w-[120px]" />
    </div>

    <div class="mt-2 text-sm gap-y-2 flex flex-col items-center justify-center">
      <div
        id="guest-name"
        class="mt-2 px-6 py-2 text-red-400 font-semibold rounded-3xl text-center inline-block"
      >
        Nama Tamu
      </div>

      <button
        id="openButton"
        type="button"
        onclick="handleClick()"
        class="mt-4 border-2 py-2 px-4 border-white/30 cursor-pointer inline-flex items-center justify-center gap-2 uppercase text-white/30 hover:bg-red-600 hover:text-white hover:border-red-600 transition-all duration-300 ease-in-out group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 640 640"
          class="h-6 w-6 fill-white/30 group-hover:fill-white"
        >
          <path
            d="M576 480C576 515.3 547.5 544 512.1 544L128 544C92.6 544 64 515.3 64 480L64 228C64.1 212.5 71.8 198 84.5 189.2L270 61.3C300.1 40.6 339.8 40.6 369.9 61.3L555.5 189.2C568.3 198 575.9 212.5 576 228L576 480zM128 496L512.1 496C520.9 496 528 488.9 528 480L528 288.3L373.2 405.7C341.8 429.6 298.3 429.6 266.8 405.7L112 288.3L112 480C112 488.9 119.2 496 128 496zM527.6 228.4L342.7 100.8C329 91.4 311 91.4 297.3 100.8L112.4 228.4L295.8 367.5C310.1 378.3 329.9 378.3 344.2 367.5L527.6 228.4z"
          ></path></svg
        >
        <span>Buka Undangan</span>
      </button>
    </div>
  </div>

  <script is:inline>
    const params = new URLSearchParams(window.location.search);
    const guest = params.get("to");
    const guestBox = document.getElementById("guest-name");

    if (guest) {
      // Ubah menjadi kapitalisasi awal huruf
      const formattedName = guest
        .replace(/-/g, " ")
        .replace(/\b\w/g, (c) => c.toUpperCase());
      guestBox.textContent = formattedName;
    }

    document.documentElement.style.overflow = "hidden";
    document.body.style.overflow = "hidden";

    function handleClick() {
      // Unlock scroll
      document.getElementById("openButton").style.display = "none";
      document.documentElement.style.overflow = "auto";
      document.body.style.overflow = "auto";

      // Scroll halus ke section #isi
      scrollToElement("#isi", 1000);
    }
    function scrollToElement(selector, duration = 1000) {
      const target = document.querySelector(selector);
      if (!target) return;

      const targetPos = target.getBoundingClientRect().top + window.scrollY;
      const start = window.scrollY;
      const startTime = performance.now();

      function scrollStep(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const ease = 1 - Math.pow(1 - progress, 3); // cubic easing

        const scrollY = start + (targetPos - start) * ease;
        window.scrollTo(0, scrollY);

        if (elapsed < duration) {
          requestAnimationFrame(scrollStep);
        }
      }

      requestAnimationFrame(scrollStep);
    }
  </script>
</section>
